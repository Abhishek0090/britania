import{a as m}from"./react-31052980.js";import{d as T}from"./chevron-left-00fe92ff.js";import{u as z,a as r,j as a,F as A,_ as p}from"./index-a4114ef4.js";import{s as R,d as X,U as Y,aU as w}from"./main-1d195725.js";import{L as B}from"./loader-2-0dcaac2c.js";import{T as J}from"./trash-6f040b71.js";import{S as W}from"./freelancerSlice-60742dc0.js";const c=10,Z=10242880,D=()=>{var j,F,I;const b=W(),s=z(t=>t.student.allNonLoggedPlagiarismDetails),M=z(R),[n,S]=m.useState([]),[y,O]=m.useState(null),[G,v]=m.useState(!1),[q,h]=m.useState(!1);m.useState(!1);const L=m.useRef(null);T();const E=async t=>{let l=[...n],_=!1;h(!0),t.forEach(e=>{if(l.length<c){if(e.size>Z){p.error("File size is too large"),h(!1);return}l.push(e)}else _=!0,p.error("You can upload maximum 10 files"),h(!1)}),S(l);let o=JSON.parse(localStorage.getItem("assignment_files_random_number")?localStorage.getItem("assignment_files_random_number"):y),x={plagiarism_assignment:l,team_member_id:M.teamData.id,submit:"submit",random_number:o||y};await X.post(`${Y}/team/fileuploadplagcheck.php`,x,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{var d,u,g,f;O((d=e==null?void 0:e.data)==null?void 0:d.random_number),console.log(e),localStorage.setItem("assignment_files_random_number",(u=e==null?void 0:e.data)==null?void 0:u.random_number),b(w({assignment_files:(g=e==null?void 0:e.data)==null?void 0:g.file_name_string,assignment_files_random_number:(f=e==null?void 0:e.data)==null?void 0:f.random_number})),p.success("File Uploaded Successfully")}).catch(e=>{console.log(e)}),h(!1),v(!!_)},P=t=>{var d,u,g,f,U,$,k,C;let l=JSON.parse(localStorage.getItem("assignment_files_random_number")?localStorage.getItem("assignment_files_random_number"):y),_=t.split(`${l}`)[1];console.log(t);let o=[...n],x=o.findIndex(i=>i===_);if(x===-1){let i=(f=(g=(u=(d=s==null?void 0:s.assignment_files)==null?void 0:d.split("_$_"))==null?void 0:u.filter(N=>N!==""))==null?void 0:g.filter(N=>N!==t))==null?void 0:f.join("_$_");b(w({assignment_files:i}))}o.splice(x,1);let e=(C=(k=($=(U=s==null?void 0:s.assignment_files)==null?void 0:U.split("_$_"))==null?void 0:$.filter(i=>i!==""))==null?void 0:k.filter(i=>i!==t))==null?void 0:C.join("_$_");b(w({assignment_files:e})),L.current.value=null,S(o)};return r("section",{id:"plagerismcheck",children:[a("label",{className:" mt-4 mb-2 text-xl font-medium flex items-center justify-center",children:"Upload Plagiarism Files"}),r("div",{className:"flex flex-col gap-2 md:w-[45rem] w-[20rem] items-center justify-center mt-4 mb-2",children:[(n==null?void 0:n.length)>c?null:a("div",{className:"flex items-center justify-center w-full pb-2 ",children:r("label",{htmlFor:"dropzone-file",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed  cursor-pointer  dark:hover:bg-bray-800 hover:bg-gray-100 bg-white rounded-xl shadow-lg  bg-opacity-20 backdrop-blur-lg drop-shadow-lg",children:[a(A,{children:q?r("div",{role:"status",className:"flex items-center justify-center gap-2",children:[a(B,{size:20,className:"animate-spin"}),a("span",{className:"capitalize",children:"Please wait..."})]}):r(A,{children:[a("svg",{"aria-hidden":"true",className:"w-10 h-10 mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),a("p",{className:"mb-2 text-sm text-gray-500 ",children:a("p",{className:"font-semibold text-center px-5 md:px-2",children:"Upload assignment guidelines and other related files (Can upload max 10 files)"})}),a("p",{className:"text-xs text-gray-500 ",children:"DOC, DOCX, etc up to 10MB each"})]})}),a("input",{multiple:!0,id:"dropzone-file",type:"file",className:"hidden",accept:".pdf,.doc, .docx",ref:L,onChange:t=>{let l=[...t.target.files];if((l==null?void 0:l.length)>c){p.error(`You can upload only ${c} files`);return}if((l==null?void 0:l.length)+(n==null?void 0:n.length)>c){p.error(`You can upload only ${c} files`);return}E(l)}})]})}),(I=(F=(j=s==null?void 0:s.assignment_files)==null?void 0:j.split("_$_"))==null?void 0:F.filter(t=>t!==""))==null?void 0:I.map((t,l)=>r("div",{className:"flex items-center  justify-between w-full bg-gray-200 text-gray-800 px-2 rounded-lg my-0.5",children:[r("span",{className:"p-1 rounded-lg ",children:[l+1,"."," ",t==null?void 0:t.replace(s==null?void 0:s.assignment_files_random_number,"")]}),a("button",{onClick:()=>{P(t)},className:"m-1 leading-none text-white  rounded-full hover:text-gray-100",children:a(J,{color:"red",size:20})})]},l))]})]})},ae=D;export{ae as F};
