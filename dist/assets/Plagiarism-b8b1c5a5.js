import{a as o}from"./react-31052980.js";import{d as G}from"./chevron-left-00fe92ff.js";import{u as H,_ as d,a as m,F as k,j as a}from"./index-a4114ef4.js";import{aT as _,d as M,U as W,W as K,m as Q}from"./main-1d195725.js";import{S as D,am as ee}from"./freelancerSlice-60742dc0.js";import{L as te}from"./loader-2-0dcaac2c.js";import{T as ae}from"./trash-6f040b71.js";import{A as le}from"./arrow-right-circle-12522627.js";import"./TextField-d5ff1ee4.js";import"./MenuItem-030e42a2.js";const u=10,ie=10242880;function _e(){var $,A,U;const g=D(),i=H(e=>e.student.allPlagiarismDetails),[se,q]=o.useState([]);o.useEffect(()=>{if(localStorage.getItem("Assignform")){let e=JSON.parse(localStorage.getItem("Assignform"));q(e[0].Step1),g(_({user_id:JSON.parse(localStorage.getItem("id"))||5,domain:e[0].Step1,stream:e[0].Step1}))}else console.log("no form found"),L("/freelance")},[localStorage.getItem("Assignform")]);const[c,I]=o.useState([]),[w,J]=o.useState([]),[S,B]=o.useState(null),[ne,j]=o.useState(!1),[C,b]=o.useState(!1),[X,N]=o.useState(!1),F=o.useRef(null),L=G(),Y=async e=>{let t=[...c],s=!1;b(!0),e.forEach(l=>{if(t.length<u){if(l.size>ie){d.error("File size is too large"),b(!1);return}t.push(l)}else s=!0,d.error("You can upload maximum 10 files"),b(!1)}),I(t),t.forEach(l=>{w.push(l.name)});let r=JSON.parse(localStorage.getItem("assignment_files_random_number")?localStorage.getItem("assignment_files_random_number"):S),x={plagiarism_assignment:t,submit:"submit",random_number:r||S};await M.post(`${W}/student/fileuploadsubmitassignmentplagiarismcheck.php`,x,{headers:{"Content-Type":"multipart/form-data"}}).then(l=>{var f,y,p,h;B((f=l==null?void 0:l.data)==null?void 0:f.random_number),console.log(l),localStorage.setItem("assignment_files_random_number",(y=l==null?void 0:l.data)==null?void 0:y.random_number),g(_({assignment_files:(p=l==null?void 0:l.data)==null?void 0:p.file_name_string,assignment_files_random_number:(h=l==null?void 0:l.data)==null?void 0:h.random_number}))}).catch(l=>{console.log(l)}),b(!1),j(!!s)},V=e=>{var p,h,P,z,E,O,R,T;let t=JSON.parse(localStorage.getItem("assignment_files_random_number")?localStorage.getItem("assignment_files_random_number"):S),s=e.split(`${t}`)[1],r=[...c],x=r.findIndex(n=>n===s);if(x===-1){let n=(z=(P=(h=(p=i==null?void 0:i.assignment_files)==null?void 0:p.split("_$_"))==null?void 0:h.filter(v=>v!==""))==null?void 0:P.filter(v=>v!==e))==null?void 0:z.join("_$_");g(_({assignment_files:n}))}r.splice(x,1);const f=((T=(R=(O=(E=i==null?void 0:i.assignment_files)==null?void 0:E.split("_$_"))==null?void 0:O.filter(n=>n!==""))==null?void 0:R.filter(n=>n!==e))==null?void 0:T.join("_$_")).split("_$_").filter(n=>n!=="").map(n=>n.replace(/^\d+/,"")).join("_$_"),y=[].concat(f);J(y),g(_({assignment_files:f})),F.current.value=null,I(r)};console.log(w);const Z=ee({enableReinitialize:!0,initialValues:{},onSubmit:async e=>{if(!i.assignment_files){d.error("Please Upload A File");return}N(!0);const t={...e,user_id:localStorage.getItem("id")||5,assignment_files:i==null?void 0:i.assignment_files,assignment_files_random_number:i==null?void 0:i.assignment_files_random_number,domain:"Plagiarism Check",submit:"submit"};console.log(t),await M.post(`${W}/student/submitassignmentplagiarismcheck.php`,t).then(s=>{console.log(s),N(!1),g(_({...i,assignment_array:w,assignment_files:null,assignment_files_random_number:null,assignment_id:s.data.id,number_of_files:s.data.number_of_files,price:s.data.price,amount:s.data.amount})),L("/submit/plagiarism-check/checkout")}).catch(s=>{console.log(s),N(!1),d.error("Something went wrong")})}});return m(k,{children:[" ",a(K,{children:a("title",{children:"Plagiarism Check"})}),m("div",{className:" backdrop-blur-2xl drop-shadow shadow-2xl rounded-xl py-8 md:my-5 flex-col bg-white bg-opacity-20  max-w-[70rem] mt-8 mb-6 mx-auto flex   px-5 md:px-0  items-center",children:[a("div",{className:"flex flex-col items-center justify-center gap-2 md:flex-row",children:a("div",{className:" py-5 max-w-[100rem] mx-auto flex md:flex-row flex-col px-5 md:px-0 justify-between items-center",children:a("button",{className:"flex-col max-w-sm px-10 bg-white border border-gray-200 rounded-lg shadow-2xl  backdrop-blur-3xl",children:a("div",{className:"p-5",children:a("h5",{className:"mb-2 text-2xl font-bold tracking-tight text-gray-900 ",children:"Check Plagiarism"})})})})}),m("section",{id:"plagerismcheck",children:[a("label",{className:" mt-4 mb-5 text-xl font-medium flex items-center justify-center",children:"Note : We Will Use Turnitin to Check Plagiarism Each File Will Cost â‚¹ 200"}),m("div",{className:"flex flex-col gap-2 md:w-[45rem] w-[20rem] items-center justify-center mt-4 mb-2",children:[(c==null?void 0:c.length)>u?null:a("div",{className:"flex items-center justify-center w-full pb-2 ",children:m("label",{htmlFor:"dropzone-file",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed  cursor-pointer  dark:hover:bg-bray-800 hover:bg-gray-100 bg-white rounded-xl shadow-lg  bg-opacity-20 backdrop-blur-lg drop-shadow-lg",children:[a(k,{children:C?m("div",{role:"status",className:"flex items-center justify-center gap-2",children:[a(te,{size:20,className:"animate-spin"}),a("span",{className:"capitalize",children:"Please wait..."})]}):m(k,{children:[a("svg",{"aria-hidden":"true",className:"w-10 h-10 mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),a("p",{className:"mb-2 text-md text-gray-500 ",children:a("p",{className:"font-semibold text-center px-5 md:px-2",children:"Upload assignment guidelines and other related files (Can upload max 10 files)"})}),a("p",{className:"text-sm text-gray-500 ",children:"DOC, DOCX, etc up to 10MB each"})]})}),a("input",{multiple:!0,id:"dropzone-file",type:"file",className:"hidden",accept:".doc, .docx",ref:F,onChange:e=>{let t=[...e.target.files];if((t==null?void 0:t.length)>u){d.error(`You can upload only ${u} files`);return}if((t==null?void 0:t.length)+(c==null?void 0:c.length)>u){d.error(`You can upload only ${u} files`);return}const s=t.filter(r=>!r.name.match(/\.(doc|docx)$/i));if(s.length>0){d.error(`Unsupported file type(s): ${s.map(r=>r.name).join(", ")}`);return}Y(t)}})]})}),(U=(A=($=i==null?void 0:i.assignment_files)==null?void 0:$.split("_$_"))==null?void 0:A.filter(e=>e!==""))==null?void 0:U.map((e,t)=>m("div",{className:"flex items-center  justify-between w-full bg-gray-200 text-gray-800 px-2 rounded-lg my-0.5",children:[m("span",{className:"p-1 rounded-lg ",children:[t+1,"."," ",e==null?void 0:e.replace(i==null?void 0:i.assignment_files_random_number,"")]}),a("button",{onClick:()=>{V(e)},className:"m-1 leading-none text-white  rounded-full hover:text-gray-100",children:a(ae,{color:"red",size:20})})]},t))]})]}),a(Q,{loading:X,onClick:Z.handleSubmit,variant:"contained",color:"primary",type:"submit",disabled:C,endIcon:a(le,{}),sx:{bgcolor:"#2956A8",color:"#fff",borderRadius:"1000px",mt:2,height:"50px","&:hover":{backgroundColor:"#fff",color:"#000"}},children:"Submit"})]})]})}export{_e as default};
